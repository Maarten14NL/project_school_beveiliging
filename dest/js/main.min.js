
function updateSteps(){var e=1;$(".js-stepnr").each(function(){$(this).html(e),e++})}function checkAlert(){3!=loggedInUser.level||alertActive||1!=loggedIn||$.post("include/getScenariosActive.php",{},function(e,s){e=JSON.parse(e),console.log(e),e.length>0&&($(".scenario").modal("show"),$(".scenario.modal").find(".modal-title").html(e[0].name+" in lokaal: "+e[0].location),alertActive=!0,e[0].tools||$(".scenario.modal").find(".modal-body").html("De docent heeft toegang tot deze hulpmiddelen uitgeschakeld"))}),setTimeout(checkAlert,1e3)}$("body").on("propertychange input",".js-newstep",function(e){var s=$(this).closest(".js-step");if($(s).is(":last-child")){var n=$(".js-lastnr").html(),a=parseInt(n)+1;$(".js-lastnr").removeClass("js-lastnr"),$(".js-copystep").clone().appendTo(".js-steps-container").removeClass("js-copystep").removeClass("hidden").addClass("js-step").find(".js-newnr").removeClass("js-newnr").addClass("js-lastnr").html(a),updateSteps()}}),$("body").on("click",".js-addstep",function(){var e=$(".js-lastnr").html(),s=parseInt(e)+1;$(".js-lastnr").removeClass("js-lastnr"),$(".js-copystep").clone().appendTo(".js-steps-container").removeClass("js-copystep").removeClass("hidden").addClass("js-step").find(".js-newnr").removeClass("js-newnr").addClass("js-lastnr").html(s),updateSteps()}),$("body").on("click",".js-save-new-scenario",function(){var e=$(".js-new-scenario-name").val(),s=[];""==e?showFlashMessage("Vul eerst een naam in","danger"):($(".js-newstep").each(function(){var e=$(this).val();""!=e&&s.push(e)}),0==s.length?showFlashMessage("Vul minstens 1 stap in","danger"):$.post("include/saveNewScenario.php",{name:e,steps:s},function(e,s){"succes"==e&&(showFlashMessage("Scenario succesvol toegevoegd","success"),$(".js-steps-container").html(""),$(".js-new-scenario-name").val(""),$(".js-copystep").clone().appendTo(".js-steps-container").removeClass("js-copystep").removeClass("hidden").addClass("js-step").addClass("Uniquetemp").find(".js-newnr").removeClass("js-newnr").addClass("js-lastnr").html("1"))}))}),$("body").on("click",".js-delete-step",function(){var e=$(this).closest(".js-step");$(e).is(":first-child")?showFlashMessage("Je kunt niet de eerste stap verwijderen","danger"):($(e).remove(),updateSteps())}),setTimeout(checkAlert,1e3),$(".scenario").on("hidden.bs.modal",function(){console.log("close"),3==loggedInUser.level&&1==loggedIn&&(alertActive=!1)}),$("body").on("click",".close-confirm",function(){$(".js-confirm").modal("hide")}),$("body").on("click",".confirm-save-change",function(){$(".js-confirm").modal("hide")}),$("body").on("click",".level2-btn-delete",function(){for(var e=$(this).parent().parent().attr("class"),s=$(this).parent().parent().attr("class").split("index")[1],n=0;n<scenarios.length;n++)scenarios[n].id==s&&$.post("include/deleteScenarios.php",{id:scenarios[n].id},function(s,a){console.log(s),"successuccessucces"==s&&(console.log(e),scenarios.splice(n,1),$("."+e).remove(),updateLevel2Templates())})});var rowClass="",row="";$("body").on("click",".level1-btn-delete",function(){confirmModal("Gebruiker Verwijderen","Weet u zeker dat u deze gebruiker wilt verwijderen","confirm-user-delete"),rowClass=$(this).parent().parent().attr("class"),row=$(this).parent().parent().attr("class").split("index")[1],console.log(users)}),$("body").on("click",".confirm-user-delete",function(){console.log("user-delete");for(var e=0;e<users.length;e++)users[e].id==row&&$.post("include/deleteUser.php",{id:users[e].id},function(e,s){"succes"==e&&(showFlashMessage("U heeft de gebruiker succesvol verwijderd","success"),$("."+rowClass).remove())})});var rowSelected=0,index=0,descriptions=[];$("body").on("click",".level2-btn-edit",function(){rowSelected=$(this).parent().parent().attr("class");for(var e=0;e<scenarios.length;e++)scenarios[e].id==rowSelected.split("index")[1]&&(index=e);$.post("include/getScenerioDesc.php",{id:scenarios[index].id},function(e,s){(descriptions=JSON.parse(e)).map(function(e,s){e.index=s+1}),console.log(descriptions);var n=$(".level2-scenario-edit-template").html(),a=Mustache.render(n,descriptions);$(".scenario-edit-options-container").html(a),$(".scenario-edit").modal("show"),$(".update-scenarios-name").val(scenarios[index].name)})}),$("body").on("click",".update-scenarios-update",function(){descriptionNames=[],console.log(scenarios[index]);for(var e=1;e<descriptions.length+1;e++)""!=$(".js-scenario-edit-"+e).val()&&descriptionNames.push($(".js-scenario-edit-"+e).val());console.log(descriptionNames),$.post("include/updateScenario.php",{scenarioID:scenarios[index].id,name:$(".update-scenarios-name").val(),descriptions:descriptions},function(e,s){console.log(e),$(".scenario-edit").modal("hide")})}),$("body").on("click",".js-scenario-edit-delete",function(){var e=$(this).closest(".js-scenario-edit-step");$(e).is(":first-child")?showFlashMessage("Je kunt niet de eerste stap verwijderen","danger"):($(e).remove(),updateSteps())});rowSelected=0,index=0;function showFlashMessage(e,s,n=!1,a=2e3){var o=$(".js-flash");$(o).removeClass("alert-danger").removeClass("alert-success").addClass("flash-message--show").addClass("alert-"+s).html(e),n?$(o).append('<button class="js-dismiss btn">Ok</button>'):setTimeout(function(){unshowFlashMessage()},a)}function unshowFlashMessage(){var e=$(".js-flash");console.log(e),$(e).removeClass("flash-message--show")}function login(e){switch($(".login-container").addClass("hidden"),$(".login-status").text("Welkom: "+loggedInUser.username+"    "),$(".logout").removeClass("hidden"),loggedIn=!0,userLevel=e,$(".user-level").addClass("hidden"),$(".view").addClass("hidden"),userLevel){case 1:$(".user-level_1").removeClass("hidden"),$(".view_1-1").removeClass("hidden"),$(".option_1").addClass("options--active"),$(".settings").removeClass("hidden"),updateLevel1Templates();break;case 2:$(".user-level_2").removeClass("hidden"),$(".view_2-1").removeClass("hidden"),$(".option_1").addClass("options--active"),$(".settings").removeClass("hidden"),updateLevel2Templates();break;case 3:$(".user-level_3").removeClass("hidden")}}function logout(){$(".login-container").removeClass("hidden"),$(".login-status").text("U bent nog niet ingelogd"),$(".logout").addClass("hidden"),$(".user-level").addClass("hidden"),$(".settings").addClass("hidden"),loggedIn=!1,userLevel=0,$.post("include/login.php",{logoutSub:""},function(e,s){showFlashMessage("Je bent uitgelogd","success")})}function updateLevel1Templates(){$.post("include/getUsers.php",{},function(e,s){users=JSON.parse(e);for(var n=0;n<2;n++){users.map(function(e,s){e.index=e.id,2==e.userlevel?e.level="Docent":3==e.userlevel&&(e.level="Student"),0==n?(e.class="edit",e.classText="aanpassen"):1==n&&(e.class="delete",e.classText="verwijderen")});for(var a=0;a<users.length;a++)1==users[a].userlevel&&users.splice(a,1);$(".new-user-name").val(""),$(".new-user-password").val(""),$(".new-user-options").removeAttr("selected"),$(".new-user-option1").attr("selected","selected");var o=$(".level1-user-template").html(),l=Mustache.render(o,users);0==n?$(".user-level1-edit").html(l):1==n&&$(".user-level1-delete").html(l)}})}function updateLevel2Templates(){$.post("include/getScenarios.php",{},function(e,s){scenarios=JSON.parse(e),$(".scenario-selector").html("");for(var n=0;n<scenarios.length;n++)$(".scenario-selector").append('<option data-id="'+scenarios[n].id+'">'+scenarios[n].name+"</option>");var a=$(".level2-scenario-template").html(),o=Mustache.render(a,scenarios);$(".js-scenario-container").html(o)})}$("body").on("click",".level1-btn-edit",function(){rowSelected=$(this).parent().parent().attr("class");for(var e=0;e<users.length;e++)users[e].id==rowSelected.split("index")[1]&&(index=e);$(".update-users").modal("show"),$(".update-users-username").val(users[index].username),$(".update-user-options").removeAttr("selected"),2==users[index].userlevel?$(".update-user-option2").attr("selected","selected"):$(".update-user-option1").attr("selected","selected")}),$("body").on("click",".update-users-update",function(){""==$(".update-users-username").val()&&""==$(".update-users-password").val()&&""==$(".update-users-repeat-password").val()?(console.log("gebruikersnaam en wachtwoord mogen niet leeg zijn"),showFlashMessage("Gebruikers naam mag niet leeg zijn","danger")):""==$(".update-users-username").val()?showFlashMessage("Uw gebruikersnaam mag niet leeg zijn","danger"):$(".update-users-password").val()!=$(".update-users-repeat-password").val()?showFlashMessage("Uw wachtwoorden zijn niet gelijk aan elkaar","danger"):$.post("include/updateUser.php",{id:users[index].id,name:$(".update-users-username").val(),pass:$(".update-users-password").val(),level:$(".update-user-level").val()},function(e,s){"succes"==e&&($(".update-users").modal("hide"),users[index].username=$(".update-users-username").val(),updateLevel1Templates())})}),$("body").on("click",".js-dismiss",function(){unshowFlashMessage()});var confirmClassOld="",deleteClassOld="";function confirmModal(e,s,n,a){void 0==a&&(a="close-confirm"),""!=n&&""!=deleteClassOld&&($(".confirm-save-change").removeClass(confirmClassOld),$(".confirm-delete-change").removeClass(deleteClassOld)),$(".confirm-save-change").addClass(n),$(".confirm-delete-change").addClass(a),confirmClassOld=n,deleteClassOld=a,$(".confirm-title").text(e),$(".confirm-text").text(s),$(".js-confirm").modal("show")}var loggedIn=!1,userLevel=0,loggedInUser=[],users=[],scenarios=[],alertActive=!1;$(document).ready(function(){console.log("home.js loaded"),$("body").on("click",".menu-item",function(){var e=$(this).attr("class").split("_")[1];console.log(e),$(".verdieping").addClass("hidden"),$(".verdieping__"+e).removeClass("hidden")}),$("body").on("click",".login",function(){console.log($(".username").val().toLowerCase()),console.log($(".password").val().toLowerCase()),$.post("include/login.php",{loginSub:"",username:$(".username").val().toLowerCase(),password:$(".password").val()},function(e,s){var n=JSON.parse(e);console.log(n),loggedInUser=n,1==n.loggedIn?(login(n.level),showFlashMessage("U bent succesvol ingelogd","success")):showFlashMessage("Uw gebruikersnaam of wachtwoord is incorrect","danger")})}),$("body").on("click",".logout",function(){logout()}),$("body").on("click",".lokaal",function(){if(console.log(loggedIn),1==loggedIn){var e=$(this).attr("class").split(" ")[0];$(".js-lokaal").html(e)}}),$(document).keypress(function(e){13==e.which&&(loggedIn||$(".login").trigger("click"))})}),$("body").on("click",".lokaal",function(){if(loggedIn){var e=$(this).attr("class").split(" ")[0];$(".js-lokaal").html(e)}}),$("body").on("click",".js-start-scenario",function(){if(loggedIn){var e=$(".js-lokaal").html(),s=$(".js-scenarioselect").find(":selected").data("id"),n=0;$(".js-switch").is(":checked")&&(n=1),""!=e?s>=1?$.post("include/makeActiveScenario.php",{lokaalnr:e,scenarioId:s,tools:n},function(e,s){"success"==e?showFlashMessage("Scenario is succesvol aangemaakt","success"):showFlashMessage("Het maken van een scenario is mislukt","danger")}):showFlashMessage("Er is geen scenario gekozen","danger"):showFlashMessage("Kies een lokaal","danger")}}),$("body").on("click",".new-user",function(){""==$(".new-user-name").val()||""==$(".new-user-password").val()||null==$(".new-user-level").val()?""==$(".new-user-name").val()?showFlashMessage("U heeft nog geen gebruikersnaam ingevuld","danger"):""==$(".new-user-password").val()?showFlashMessage("U heeft nog geen passwoord ingevuld","danger"):null==$(".new-user-level").val()&&showFlashMessage("U heeft nog geen level geselecteerd","danger"):(console.log($(".new-user-level").val()),$.post("include/addUser.php",{username:$(".new-user-name").val(),userpassword:$(".new-user-password").val(),userlevel:$(".new-user-level").val()},function(e,s){console.log(e),"success"==e&&(showFlashMessage("Er is een nieuwe gebruiker aangemaakt","success"),$(".new-user-name").val(""),$(".new-user-password").val(""),$(".new-user-options").removeAttr("selected"),$(".new-user-option1").attr("selected","selected"))}))}),$("body").on("click",".options",function(){var e=$(this).attr("class").split(" ")[1].split("_")[1],s=$(this).attr("class").split(" ")[2].split("_")[1];switch(console.log(e),$(".view").addClass("hidden"),$(".view_"+e+"-"+s).removeClass("hidden"),$(".options").removeClass("options--active"),$(this).addClass("options--active"),e){case"1":updateLevel1Templates();break;case"2":updateLevel2Templates()}}),$(document).ready(function(){$.post("include/returnSession.php",{},function(e,s){var n=JSON.parse(e);n.loggedIn&&(loggedInUser=n,login(n.level))})}),$(".settings-inputs").keypress(function(e){console.log("enter"),13==e.which&&$(".settings-update").trigger("click")}),$("body").on("click",".settings",function(){console.log("settings"),$(".settings-username").val(loggedInUser.username),$(".user-settings").modal("show"),console.log(loggedInUser.username)}),$("body").on("click",".settings-update",function(){console.log("update"),console.log($(".settings-username").val()),console.log($(".settings-password").val()),console.log($(".settings-repeat-password").val()),""==$(".settings-username").val()&&""==$(".settings-password").val()&&""==$(".settings-repeat-password").val()?console.log("gebruikersnaam en wachtwoord mogen niet leeg zijn"):$(".settings-password").val()!=$(".settings-repeat-password").val()?console.log("wachtwoorden zijn niet gelijk aan elkaar"):(console.log(loggedInUser),$.post("include/updateUser.php",{id:loggedInUser.userID,name:$(".settings-username").val(),pass:$(".settings-password").val()},function(e,s){console.log(e),"succes"==e&&$(".user-settings").modal("hide")}))});
=======
function updateSteps(){var e=1;$(".js-stepnr").each(function(){$(this).html(e),e++})}function checkAlert(){3!=loggedInUser.level||alertActive||1!=loggedIn||$.post("include/getScenariosActive.php",{},function(e,s){if((e=JSON.parse(e)).length>0)if($(".scenario").modal("show"),$(".scenario.modal").find(".modal-title").html(e[0].name+" in lokaal: "+e[0].location),alertActive=!0,$(".scenario.modal").find(".js-close-scenario-modal").attr("data-activeid",e[0].active_id),e[0].tools){var n=e[0].steps;console.log(n)}else $(".scenario.modal").find(".modal-body").html("De docent heeft toegang tot deze hulpmiddelen uitgeschakeld")}),setTimeout(checkAlert,1e3)}$("body").on("propertychange input",".js-newstep",function(e){var s=$(this).closest(".js-step");if($(s).is(":last-child")){var n=$(".js-lastnr").html(),o=parseInt(n)+1;$(".js-lastnr").removeClass("js-lastnr"),$(".js-copystep").clone().appendTo(".js-steps-container").removeClass("js-copystep").removeClass("hidden").addClass("js-step").find(".js-newnr").removeClass("js-newnr").addClass("js-lastnr").html(o),updateSteps()}}),$("body").on("click",".js-addstep",function(){var e=$(".js-lastnr").html(),s=parseInt(e)+1;$(".js-lastnr").removeClass("js-lastnr"),$(".js-copystep").clone().appendTo(".js-steps-container").removeClass("js-copystep").removeClass("hidden").addClass("js-step").find(".js-newnr").removeClass("js-newnr").addClass("js-lastnr").html(s),updateSteps()}),$("body").on("click",".js-save-new-scenario",function(){var e=$(".js-new-scenario-name").val(),s=[];""==e?showFlashMessage("Vul eerst een naam in","danger"):($(".js-newstep").each(function(){var e=$(this).val();""!=e&&s.push(e)}),0==s.length?showFlashMessage("Vul minstens 1 stap in","danger"):$.post("include/saveNewScenario.php",{name:e,steps:s},function(e,s){"succes"==e&&(showFlashMessage("Scenario succesvol toegevoegd","success"),$(".js-steps-container").html(""),$(".js-new-scenario-name").val(""),$(".js-copystep").clone().appendTo(".js-steps-container").removeClass("js-copystep").removeClass("hidden").addClass("js-step").addClass("Uniquetemp").find(".js-newnr").removeClass("js-newnr").addClass("js-lastnr").html("1"))}))}),$("body").on("click",".js-delete-step",function(){var e=$(this).closest(".js-step");$(e).is(":first-child")?showFlashMessage("Je kunt niet de eerste stap verwijderen","danger"):($(e).remove(),updateSteps())}),setTimeout(checkAlert,1e3),$("body").on("click",".js-close-scenario-modal",function(){var e=$(this).attr("data-activeid");console.log(e),$.post("include/finishActiveScenario",{activeid:e},function(e,s){console.log(e)})}),$(".scenario").on("hidden.bs.modal",function(){console.log("close"),3==loggedInUser.level&&1==loggedIn&&(alertActive=!1)}),$("body").on("click",".level2-btn-delete",function(){for(var e=$(this).parent().parent().attr("class"),s=$(this).parent().parent().attr("class").split("index")[1],n=0;n<scenarios.length;n++)scenarios[n].id==s&&$.post("include/deleteScenarios.php",{id:scenarios[n].id},function(s,o){console.log(s),"successuccessucces"==s&&(console.log(e),scenarios.splice(n,1),$("."+e).remove(),updateLevel2Templates())})}),$("body").on("click",".level1-btn-delete",function(){var e=$(this).parent().parent().attr("class"),s=$(this).parent().parent().attr("class").split("index")[1];console.log(users);for(var n=0;n<users.length;n++)users[n].id==s&&$.post("include/deleteUser.php",{id:users[n].id},function(s,n){"succes"==s&&(console.log(e),console.log("asd"),$("."+e).remove())})});var rowSelected=0,index=0,descriptions=[];$("body").on("click",".level2-btn-edit",function(){rowSelected=$(this).parent().parent().attr("class");for(var e=0;e<scenarios.length;e++)scenarios[e].id==rowSelected.split("index")[1]&&(index=e);$.post("include/getScenerioDesc.php",{id:scenarios[index].id},function(e,s){(descriptions=JSON.parse(e)).map(function(e,s){e.index=s+1}),console.log(descriptions);var n=$(".level2-scenario-edit-template").html(),o=Mustache.render(n,descriptions);$(".scenario-edit-options-container").html(o),$(".scenario-edit").modal("show"),$(".update-scenarios-name").val(scenarios[index].name)})}),$("body").on("click",".update-scenarios-update",function(){descriptionNames=[],console.log(scenarios[index]);for(var e=1;e<descriptions.length+1;e++)""!=$(".js-scenario-edit-"+e).val()&&descriptionNames.push($(".js-scenario-edit-"+e).val());console.log(descriptionNames),$.post("include/updateScenario.php",{scenarioID:scenarios[index].id,name:$(".update-scenarios-name").val(),descriptions:descriptions},function(e,s){console.log(e),$(".scenario-edit").modal("hide")})}),$("body").on("click",".js-scenario-edit-delete",function(){var e=$(this).closest(".js-scenario-edit-step");$(e).is(":first-child")?showFlashMessage("Je kunt niet de eerste stap verwijderen","danger"):($(e).remove(),updateSteps())});rowSelected=0,index=0;function login(e){switch($(".login-container").addClass("hidden"),$(".login-status").text("Welkom: "+loggedInUser.username+"    "),$(".logout").removeClass("hidden"),loggedIn=!0,userLevel=e,$(".user-level").addClass("hidden"),$(".view").addClass("hidden"),userLevel){case 1:$(".user-level_1").removeClass("hidden"),$(".view_1-1").removeClass("hidden"),$(".option_1").addClass("options--active"),$(".settings").removeClass("hidden"),updateLevel1Templates();break;case 2:$(".user-level_2").removeClass("hidden"),$(".view_2-1").removeClass("hidden"),$(".option_1").addClass("options--active"),$(".settings").removeClass("hidden"),updateLevel2Templates();break;case 3:$(".user-level_3").removeClass("hidden")}}function logout(){$(".login-container").removeClass("hidden"),$(".login-status").text("U bent nog niet ingelogd"),$(".logout").addClass("hidden"),$(".user-level").addClass("hidden"),$(".settings").addClass("hidden"),loggedIn=!1,userLevel=0,console.log("logout"),$.post("include/login.php",{logoutSub:""},function(e,s){showFlashMessage("Je bent uitgelogd","success")})}function updateLevel1Templates(){$.post("include/getUsers.php",{},function(e,s){users=JSON.parse(e);for(var n=0;n<2;n++){users.map(function(e,s){e.index=e.id,2==e.userlevel?e.level="Docent":3==e.userlevel&&(e.level="Student"),0==n?(e.class="edit",e.classText="aanpassen"):1==n&&(e.class="delete",e.classText="verwijderen")});for(var o=0;o<users.length;o++)1==users[o].userlevel&&users.splice(o,1);var a=$(".level1-user-template").html(),t=Mustache.render(a,users);0==n?$(".user-level1-edit").html(t):1==n&&$(".user-level1-delete").html(t)}})}function updateLevel2Templates(){$.post("include/getScenarios.php",{},function(e,s){scenarios=JSON.parse(e),console.log(scenarios),$(".scenario-selector").html("");for(var n=0;n<scenarios.length;n++)$(".scenario-selector").append('<option data-id="'+scenarios[n].id+'">'+scenarios[n].name+"</option>");var o=$(".level2-scenario-template").html(),a=Mustache.render(o,scenarios);$(".js-scenario-container").html(a)})}function randomString2(e,s="",n=null){for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",a="",t=0;t<e;t++){var l=Math.floor(Math.random()*o.length);a+=o.substring(l,l+1)}if(null==n)return s+a;var i=$.inArray(s+a,n);if(i>-1){var r=0;do{a="";for(t=0;t<e;t++){l=Math.floor(Math.random()*o.length);a+=o.substring(l,l+1)}i=$.inArray(s+a,n),r++}while(i>-1);return console.log("it took "+r+" tries"),s+a}return s+a}$("body").on("click",".level1-btn-edit",function(){rowSelected=$(this).parent().parent().attr("class");for(var e=0;e<users.length;e++)users[e].id==rowSelected.split("index")[1]&&(index=e);$(".update-users").modal("show"),$(".update-users-username").val(users[index].username),$(".update-user-options").removeAttr("selected"),2==users[index].userlevel?$(".update-user-option2").attr("selected","selected"):$(".update-user-option1").attr("selected","selected")}),$("body").on("click",".update-users-update",function(){console.log("update"),console.log($(".update-users-username").val()),console.log($(".update-users-password").val()),console.log($(".update-users-repeat-password").val()),""==$(".update-users-username").val()&&""==$(".update-users-password").val()&&""==$(".update-users-repeat-password").val()?console.log("gebruikersnaam en wachtwoord mogen niet leeg zijn"):$(".update-users-password").val()!=$(".update-users-repeat-password").val()?console.log("wachtwoorden zijn niet gelijk aan elkaar"):$.post("include/updateUser.php",{id:users[index].id,name:$(".update-users-username").val(),pass:$(".update-users-password").val(),level:$(".update-user-level").val()},function(e,s){console.log(e),"succes"==e&&($(".update-users").modal("hide"),users[index].username=$(".update-users-username").val(),console.log($("."+rowSelected).find(".username")),updateLevel1Templates())})});var loggedIn=!1,userLevel=0,loggedInUser=[],users=[],scenarios=[],alertActive=!1;$(document).ready(function(){console.log("home.js loaded"),$("body").on("click",".menu-item",function(){var e=$(this).attr("class").split("_")[1];console.log(e),$(".verdieping").addClass("hidden"),$(".verdieping__"+e).removeClass("hidden")}),$("body").on("click",".login",function(){console.log($(".username").val().toLowerCase()),console.log($(".password").val().toLowerCase()),$.post("include/login.php",{loginSub:"",username:$(".username").val().toLowerCase(),password:$(".password").val()},function(e,s){var n=JSON.parse(e);console.log(n),loggedInUser=n,1==n.loggedIn?(login(n.level),showFlashMessage("U bent succesvol ingelogd","success")):showFlashMessage("Uw gebruikersnaam of wachtwoord is incorrect","danger")})}),$("body").on("click",".logout",function(){logout()}),$("body").on("click",".lokaal",function(){if(console.log(loggedIn),1==loggedIn){var e=$(this).attr("class").split(" ")[0];$(".js-lokaal").html(e)}}),$(document).keypress(function(e){13==e.which&&(loggedIn||$(".login").trigger("click"))})}),$("body").on("click",".lokaal",function(){if(loggedIn){var e=$(this).attr("class").split(" ")[0];$(".js-lokaal").html(e)}}),$("body").on("click",".js-start-scenario",function(){if(loggedIn){var e=$(".js-lokaal").html(),s=$(".js-scenarioselect").find(":selected").data("id"),n=0;$(".js-switch").is(":checked")&&(n=1),""!=e?s>=1?$.post("include/makeActiveScenario.php",{lokaalnr:e,scenarioId:s,tools:n},function(e,s){"success"==e?showFlashMessage("Scenario is succesvol aangemaakt","success"):showFlashMessage("Het maken van een scenario is mislukt","danger")}):showFlashMessage("Er is geen scenario gekozen","danger"):showFlashMessage("Kies een lokaal","danger")}}),$("body").on("click",".new-user",function(){""==$(".new-user-name").val()||""==$(".new-user-password").val()||null==$(".new-user-level").val()?console.log("geen gebruikersnaam, wachtwoord of level geselecteerd"):(console.log($(".new-user-level").val()),$.post("include/addUser.php",{username:$(".new-user-name").val(),userpassword:$(".new-user-password").val(),userlevel:$(".new-user-level").val()},function(e,s){console.log(e)}))});var flashMessages=[];function showFlashMessage(e,s,n=!1,o=2e3){var a=randomString2(20);$(".js-fl-cont").append('<div id="'+a+'" class="js-flash alert-'+s+' flash-message">'+e+"</div>"),setTimeout(function(){$("#"+a).addClass("flash-message--show")},1),n?$("#"+a).append('<button data-id="'+a+'" class="js-dismiss btn">Ok</button>'):setTimeout(function(){deleteFlashMessage(a)},o)}function deleteFlashMessage(e){$("#"+e).removeClass("flash-message--show"),setTimeout(function(){$("#"+e).remove()},200)}function testflash(){showFlashMessage("test message: "+count,"success",isEven(count),1e3*count),setTimeout(function(){testflash()},2e3),count++}function isEven(e){return e%2==0}$("body").on("click",".js-dismiss",function(){deleteFlashMessage($(this).data("id"))}),count=0,$("body").on("click",".options",function(){var e=$(this).attr("class").split(" ")[1].split("_")[1],s=$(this).attr("class").split(" ")[2].split("_")[1];switch(console.log(e),$(".view").addClass("hidden"),$(".view_"+e+"-"+s).removeClass("hidden"),$(".options").removeClass("options--active"),$(this).addClass("options--active"),e){case"1":updateLevel1Templates();break;case"2":updateLevel2Templates()}}),$(document).ready(function(){$.post("include/returnSession.php",{},function(e,s){var n=JSON.parse(e);n.loggedIn&&(loggedInUser=n,login(n.level))})}),$(".settings-inputs").keypress(function(e){console.log("enter"),13==e.which&&$(".settings-update").trigger("click")}),$("body").on("click",".settings",function(){console.log("settings"),$(".settings-username").val(loggedInUser.username),$(".user-settings").modal("show"),console.log(loggedInUser.username)}),$("body").on("click",".settings-update",function(){console.log("update"),console.log($(".settings-username").val()),console.log($(".settings-password").val()),console.log($(".settings-repeat-password").val()),""==$(".settings-username").val()&&""==$(".settings-password").val()&&""==$(".settings-repeat-password").val()?console.log("gebruikersnaam en wachtwoord mogen niet leeg zijn"):$(".settings-password").val()!=$(".settings-repeat-password").val()?console.log("wachtwoorden zijn niet gelijk aan elkaar"):(console.log(loggedInUser),$.post("include/updateUser.php",{id:loggedInUser.userID,name:$(".settings-username").val(),pass:$(".settings-password").val()},function(e,s){console.log(e),"succes"==e&&$(".user-settings").modal("hide")}))});
