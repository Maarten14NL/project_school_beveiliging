function checkAlert(){3!=loggedInUser.level||alertActive||$.post("include/getScenariosActive.php",{},function(e,s){(e=JSON.parse(e)).length>0&&($(".scenario").modal("show"),alertActive=!0)}),setTimeout(checkAlert,1e3)}$(".js-newstep").on("propertychange input",function(e){var s=$(this);console.log(s);var l=$(s).closest(".js-new-scenario-steps"),o=$(l).find(".js-newstep:last-child");console.log(o),s==o&&console.log("yes")}),setTimeout(checkAlert,1e3),$(".scenario").on("hidden.bs.modal",function(){alertActive=!1}),$("body").on("click",".level1-btn-delete",function(){var e=$(this).parent().parent().attr("class"),s=$(this).parent().parent().attr("class").split("index")[1];console.log(users);for(var l=0;l<users.length;l++)users[l].id==s&&$.post("include/deleteUser.php",{id:users[l].id},function(s,l){"succes"==s&&(console.log(e),console.log("asd"),$("."+e).remove())})});var rowSelected=0,index=0;function showFlashMessage(e,s,l=2e3){var o=$(".js-flash");$(o).removeClass("alert-danger").removeClass("alert-success").addClass("flash-message--show").addClass("alert-"+s).html(e),setTimeout(function(){unshowFlashMessage()},l)}function unshowFlashMessage(){var e=$(".js-flash");console.log(e),$(e).removeClass("flash-message--show")}function login(e){switch($(".login-container").addClass("hidden"),$(".login-status").text("Welcom: "+loggedInUser.username+"  "),$(".logout").removeClass("hidden"),loggedIn=!0,userLevel=e,$(".user-level").addClass("hidden"),$(".view").addClass("hidden"),userLevel){case 1:$(".user-level_1").removeClass("hidden"),$(".view_1-1").removeClass("hidden"),$(".settings").removeClass("hidden");break;case 2:$(".user-level_2").removeClass("hidden"),$(".view_2-2").removeClass("hidden"),$(".settings").removeClass("hidden");break;case 3:$(".user-level_3").removeClass("hidden")}}function logout(){$(".login-container").removeClass("hidden"),$(".login-status").text("U bent nog niet ingelogd"),$(".logout").addClass("hidden"),$(".user-level").addClass("hidden"),$(".settings").addClass("hidden"),loggedIn=!1,userLevel=0,$.post("include/login.php",{logoutSub:""},function(e,s){showFlashMessage("Je bent uitgelogd","success")})}function updateLevel1Templates(){$.post("include/getUsers.php",{},function(e,s){users=JSON.parse(e);for(var l=0;l<2;l++){users.map(function(e,s){e.index=e.id,2==e.userlevel?e.level="Docent":3==e.userlevel&&(e.level="Student"),0==l?(e.class="edit",e.classText="aanpassen"):1==l&&(e.class="delete",e.classText="verwijderen")});for(var o=0;o<users.length;o++)1==users[o].userlevel&&users.splice(o,1);var n=$(".level1-user-template").html(),a=Mustache.render(n,users);0==l?$(".user-level1-edit").html(a):1==l&&$(".user-level1-delete").html(a)}})}$("body").on("click",".level1-btn-edit",function(){rowSelected=$(this).parent().parent().attr("class");for(var e=0;e<users.length;e++)users[e].id==rowSelected.split("index")[1]&&(index=e);$(".update-users").modal("show"),$(".update-users-username").val(users[index].username),$(".update-user-options").removeAttr("selected"),2==users[index].userlevel?$(".update-user-option2").attr("selected","selected"):$(".update-user-option1").attr("selected","selected")}),$("body").on("click",".update-users-update",function(){console.log("update"),console.log($(".update-users-username").val()),console.log($(".update-users-password").val()),console.log($(".update-users-repeat-password").val()),""==$(".update-users-username").val()&&""==$(".update-users-password").val()&&""==$(".update-users-repeat-password").val()?console.log("gebruikersnaam en wachtwoord mogen niet leeg zijn"):$(".update-users-password").val()!=$(".update-users-repeat-password").val()?console.log("wachtwoorden zijn niet gelijk aan elkaar"):$.post("include/updateUser.php",{id:users[index].id,name:$(".update-users-username").val(),pass:$(".update-users-password").val(),level:$(".update-user-level").val()},function(e,s){console.log(e),"succes"==e&&($(".update-users").modal("hide"),users[index].username=$(".update-users-username").val(),console.log($("."+rowSelected).find(".username")),updateLevel1Templates())})});var loggedIn=!1,userLevel=0,loggedInUser=[],users=[],alertActive=!1;$(document).ready(function(){console.log("home.js loaded"),$("body").on("click",".menu-item",function(){var e=$(this).attr("class").split("_")[1];console.log(e),$(".verdieping").addClass("hidden"),$(".verdieping__"+e).removeClass("hidden")}),$("body").on("click",".login",function(){console.log($(".username").val().toLowerCase()),console.log($(".password").val().toLowerCase()),$.post("include/login.php",{loginSub:"",username:$(".username").val().toLowerCase(),password:$(".password").val()},function(e,s){var l=JSON.parse(e);console.log(l),loggedInUser=l,1==l.loggedIn?(login(l.level),showFlashMessage("U bent succesvol ingelogd","success")):showFlashMessage("Uw gebruikersnaam of wachtwoord is incorrect","danger")})}),$("body").on("click",".logout",function(){logout()}),$("body").on("click",".lokaal",function(){console.log(loggedIn),1==loggedIn&&console.log($(this).attr("class").split(" ")[0])}),$(document).keypress(function(e){13==e.which&&(loggedIn||$(".login").trigger("click"))})}),$("body").on("click",".new-user",function(){""==$(".new-user-name").val()||""==$(".new-user-password").val()||null==$(".new-user-level").val()?console.log("geen gebruikersnaam, wachtwoord of level geselecteerd"):(console.log($(".new-user-level").val()),$.post("include/addUser.php",{username:$(".new-user-name").val(),userpassword:$(".new-user-password").val(),userlevel:$(".new-user-level").val()},function(e,s){console.log(e)}))}),$("body").on("click",".options",function(){var e=$(this).attr("class").split(" ")[1].split("_")[1],s=$(this).attr("class").split(" ")[2].split("_")[1];switch(console.log(e),$(".view").addClass("hidden"),$(".view_"+e+"-"+s).removeClass("hidden"),e){case"1":updateLevel1Templates()}}),$(document).ready(function(){$.post("include/returnSession.php",{},function(e,s){var l=JSON.parse(e);l.loggedIn&&(loggedInUser=l,login(l.level))})}),$(".settings-inputs").keypress(function(e){console.log("enter"),13==e.which&&$(".settings-update").trigger("click")}),$("body").on("click",".settings",function(){console.log("settings"),$(".settings-username").val(loggedInUser.username),$(".user-settings").modal("show"),console.log(loggedInUser.username)}),$("body").on("click",".settings-update",function(){console.log("update"),console.log($(".settings-username").val()),console.log($(".settings-password").val()),console.log($(".settings-repeat-password").val()),""==$(".settings-username").val()&&""==$(".settings-password").val()&&""==$(".settings-repeat-password").val()?console.log("gebruikersnaam en wachtwoord mogen niet leeg zijn"):$(".settings-password").val()!=$(".settings-repeat-password").val()?console.log("wachtwoorden zijn niet gelijk aan elkaar"):(console.log(loggedInUser),$.post("include/updateUser.php",{id:loggedInUser.userID,name:$(".settings-username").val(),pass:$(".settings-password").val()},function(e,s){console.log(e),"succes"==e&&$(".user-settings").modal("hide")}))});